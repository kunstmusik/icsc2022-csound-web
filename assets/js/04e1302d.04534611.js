"use strict";(self.webpackChunkicsc_2022_csound_web=self.webpackChunkicsc_2022_csound_web||[]).push([[262],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),u=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=u(e.components);return o.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=u(n),h=a,g=p["".concat(l,".").concat(h)]||p[h]||c[h]||i;return n?o.createElement(g,r(r({ref:t},d),{},{components:n})):o.createElement(g,r({ref:t},d))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var u=2;u<i;u++)r[u]=n[u];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}p.displayName="MDXCreateElement"},2630:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>i,metadata:()=>s,toc:()=>u});var o=n(7462),a=(n(7294),n(3905));const i={sidebar_position:2},r="Tutorial 1 - Getting Started",s={unversionedId:"tutorial1-getting-started",id:"tutorial1-getting-started",title:"Tutorial 1 - Getting Started",description:'In this tutorial, we are going to take a Csound CSD and create a simple web site that will run the CSD when pressing a "Play" button. We\'ll cover a lot of essential aspects of workflow from organizing your projects, integrating Csound into a web site, and designing your projects to work on the desktop and on the web.',source:"@site/docs/tutorial1-getting-started.md",sourceDirName:".",slug:"/tutorial1-getting-started",permalink:"/icsc2022-csound-web/tutorial1-getting-started",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tutorial1-getting-started.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Csound on the Web",permalink:"/icsc2022-csound-web/"},next:{title:"Tutorial 2 - Interacting with Csound",permalink:"/icsc2022-csound-web/tutorial2-interacting-with-csound"}},l={},u=[{value:"Step 1 - Create a new project",id:"step-1---create-a-new-project",level:2},{value:"Step 2 - Add Csound to your project",id:"step-2---add-csound-to-your-project",level:2},{value:"Step 3 - Run a CSD on your website",id:"step-3---run-a-csd-on-your-website",level:2},{value:"Adding a button to start Csound",id:"adding-a-button-to-start-csound",level:3},{value:"Instantiating the Csound Engine",id:"instantiating-the-csound-engine",level:3},{value:"Loading our Csound Code and Running Csound",id:"loading-our-csound-code-and-running-csound",level:3},{value:"Step 4 - Building the Application",id:"step-4---building-the-application",level:2},{value:"Summary",id:"summary",level:2}],d={toc:u};function c(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"tutorial-1---getting-started"},"Tutorial 1 - Getting Started"),(0,a.kt)("p",null,'In this tutorial, we are going to take a Csound CSD and create a simple web site that will run the CSD when pressing a "Play" button. We\'ll cover a lot of essential aspects of workflow from organizing your projects, integrating Csound into a web site, and designing your projects to work on the desktop and on the web. '),(0,a.kt)("h2",{id:"step-1---create-a-new-project"},"Step 1 - Create a new project"),(0,a.kt)("p",null,"We are going to start off by bootstrapping a very simple JavaScript project using ",(0,a.kt)("a",{parentName:"p",href:"https://vitejs.dev/"},"vite"),". There are many great client-side web frameworks to use for making web development an enjoyable development experience; we will use this one as for this tutorial as we have found it easy to use and convenient for development."),(0,a.kt)("p",null,"First thing we'll need to do is open up a terminal and type in:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"npm create vite")),(0,a.kt)("p",null,"This may ask you install create-vite, which you can enter 'y' to proceed."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"Need to install the following packages:\n  create-vite\nOk to proceed? (y) y\n")),(0,a.kt)("p",null,"Next, the script will ask you for a project name, framework, and variant. While in real world usage you might choose something like React and Typescript, we will start off with 'Vanilla' and 'JavaScript' for this tutorial."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"\u2714 Project name: \u2026 tutorial1\n\u2714 Select a framework: \u203a Vanilla\n\u2714 Select a variant: \u203a JavaScript\n\nScaffolding project in /Users/username/examples/tutorial1...\n\nDone. Now run:\n\n  cd tutorial1\n  npm install\n  npm run dev\n")),(0,a.kt)("p",null,"The create-vite script has now created a basic project. If you follow the steps provided, you will use npm to install any dependencies listed in package.json and then start the development server using ",(0,a.kt)("inlineCode",{parentName:"p"},"npm run dev"),". If all goes well, you will see terminal output that looks like the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"  VITE v3.1.8  ready in 378 ms\n\n  \u279c  Local:   http://127.0.0.1:5173/\n  \u279c  Network: use --host to expose\n")),(0,a.kt)("p",null,"Open up a browser and navigate to the URL that Vite shows and you should see a basic Vite website. "),(0,a.kt)("h2",{id:"step-2---add-csound-to-your-project"},"Step 2 - Add Csound to your project"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"npm install @csound/browser")),(0,a.kt)("p",null,"npm will then add a dependency for the latest version of the @csound/browser on npmjs.com to your project and also download and install it to your node_modules folder. If this is successful, you will find the package contents in the node_modules/@csound/browser folder as well as see an entry in your package.json file that looks like the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'  "dependencies": {\n    "@csound/browser": "^6.18.0-beta1"\n  }\n')),(0,a.kt)("p",null,"Congratulations! Csound is now available to use in your project and you will be able to use it in your JavaScript code. Now, let's get to the exciting part and take a Csound CSD and run it on your website!"),(0,a.kt)("h2",{id:"step-3---run-a-csd-on-your-website"},"Step 3 - Run a CSD on your website"),(0,a.kt)("p",null,"Now that we have a basic website project setup, let's introduce our own code to create our own Csound-based web application. The essential steps to getting Csound running in the browser include:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Adding a button to start Csound"),(0,a.kt)("li",{parentName:"ol"},"Instantiating and configuring the Csound engine"),(0,a.kt)("li",{parentName:"ol"},"Loading our Csound code and Running Csound")),(0,a.kt)("p",null,"Let's go over each of these parts below."),(0,a.kt)("h3",{id:"adding-a-button-to-start-csound"},"Adding a button to start Csound"),(0,a.kt)("p",null,"Browsers require a user interaction (like a button press) to start running the WebAudio AudioContext. To get going, we will add a button to our HTML code and add an onClick handler to the button.  "),(0,a.kt)("p",null,"First, open up the main.js file. Replace the contents of the file with the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import './style.css'\n\ndocument.querySelector('#app').innerHTML = `\n  <div>\n    <button id='startButton'>Start</button>\n  </div>\n`\n")),(0,a.kt)("p",null,"When the page begins, main.js is included in the index.html file and the code above will run. This will find the div named app and insert HTML content. In this case, we are adding a button with the id of 'startButton' and with the text of 'Start'. "),(0,a.kt)("p",null,"Save the file and refresh the page. At this point you should see the 'Start' button on the page. "),(0,a.kt)("p",null,"Next, add the following code to the file to create an async function for starting Csound and to bind that to the button's click event:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const startCsound = async () => {\n  console.log(\"Starting Csound...\");\n}\n\ndocument.querySelector('#startButton').addEventListener('click', startCsound);\n")),(0,a.kt)("p",null,'Refresh the page, open up the JavaScript console, and hit the button. You should see "Starting Csound..." called whenever you hit the button. '),(0,a.kt)("p",null,"Note: The startCsound function is asynchronous as we will be using awaits when we interact with Csound's API, explained further below. "),(0,a.kt)("h3",{id:"instantiating-the-csound-engine"},"Instantiating the Csound Engine"),(0,a.kt)("p",null,"Now we will want to create a Csound engine for our project to use. We also want to make it so that our page only ever uses one Csound engine. (This isn't the only way to use WebAudio Csound, but it is a common use case so we will work with it here.)"),(0,a.kt)("p",null,"First, we will need to import Csound from @csound/browser. Add the following code at the very top of main.js:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import { Csound } from '@csound/browser';\n")),(0,a.kt)("p",null,"Next, replace the previous startCsound code with the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'let csound = null;\n\nconst startCsound = async () => {\n  if(csound) {\n    return;\n  }\n\n  console.log("Starting Csound...");\n\n  csound = await Csound();\n  console.log(csound) \n}\n')),(0,a.kt)("p",null,"What the above does is specify a global ",(0,a.kt)("inlineCode",{parentName:"p"},"csound")," variable that is initially set to null.  When startCsound() is called, it now checks to see if ",(0,a.kt)("inlineCode",{parentName:"p"},"csound")," has been initialized yet and, if so, returns out of the function. If not, it runs the code to create a CsoundObj instance by calling ",(0,a.kt)("inlineCode",{parentName:"p"},"await Csound()"),". "),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"WebAudio Csound comes with a number of backend implementations. Each one provides benefits and drawbacks. The Csound() function takes in an object that one can configure for various settings that can influence channel counts and backend chosen.  The return value from Csound() is an instance of CsoundObj."),(0,a.kt)("p",{parentName:"admonition"},"To clarify, CsoundObj is the interface that contains the WebAudio version of Csound API. It is an object-oriented API versus the traditional Csound C API. "),(0,a.kt)("p",{parentName:"admonition"},"By default, the single-threaded AudioWorklet version of CsoundObj is used. This implementation works well for most use cases and is recommended to use for your initial forays into WebAudio Csound.")),(0,a.kt)("p",null,"The complete code for main.js at this point should look as below:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import { Csound } from '@csound/browser';\nimport './style.css'\n\ndocument.querySelector('#app').innerHTML = `\n  <div>\n    <button id='startButton'>Start</button>\n  </div>\n`\n\nlet csound = null;\n\nconst startCsound = async () => {\n  if(csound) {\n    return;\n  }\n\n  console.log(\"Starting Csound...\");\n\n  csound = await Csound();\n}\n\ndocument.querySelector('#startButton').addEventListener('click', startCsound);\n")),(0,a.kt)("h3",{id:"loading-our-csound-code-and-running-csound"},"Loading our Csound Code and Running Csound"),(0,a.kt)("p",null,"Let's now get our Csound code running!  We will use the following Csound CSD code:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},';; Author: Steven Yi\n<CsoundSynthesizer>\n<CsOptions>\n-o dac --port=10000\n</CsOptions>\n<CsInstruments>\nsr=48000\nksmps=64\nnchnls=2\n0dbfs=1\n\ninstr 1\n    ioct = octcps(p4)\n    kpwm = oscili(.1, 5)\n    asig = vco2(p5, p4, 4, .5 + kpwm)\n    asig += vco2(p5, p4 * 2)\n\n    idepth = 3\n    acut = transegr:a(0, .002, 0, idepth, .5, -4.2, 0.001, .5, -4.2, 0)\n    asig = zdf_2pole(asig, cpsoct(ioct + acut), 0.5)\n\n    asig *= linsegr:a(1, p3, 1, .5, 0)\n\n    out(asig, asig)\n\nendin\n\ninstr Main\n    inotes[] fillarray 60, 67, 63, 65, 62\n    ioct[] fillarray 0,1,0,0,1\n    inote = inotes[p4 % 37 % 11 % 5] + 12 * ioct[p4 % 41 % 17 % 5]\n    schedule(1, 0, .25, cpsmidinn(inote), 0.25)\n\n    if(p4 % 64 % 37 % 17 % 11 == 0 && inote != 74 && inote != 62) then\n        schedule(1, 0, .5, cpsmidinn(inote + 7), 0.125)\n    endif\n\n    schedule(p1, .25, .25, p4 + 1)\nendin\n\nschedule("Main", 0, 0, 0)\n\n</CsInstruments>\n</CsoundSynthesizer>\n')),(0,a.kt)("p",null,"Save the above code in a file called tutorial1.csd in the root of your project folder (should be in the same folder as main.js). You should be able to run it on the commandline using ",(0,a.kt)("inlineCode",{parentName:"p"},"csound tutorial1.csd")," and hear a small generative music example. "),(0,a.kt)("p",null,"Next, we need to have the code accessible in our project. We will use a vite's raw loading system to import the CSD as a string by adding the following import to the top of the file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"import csd from './tutorial1.csd?raw'\n")),(0,a.kt)("p",null,"This will make the contents of the tutorial1.csd file accessible as a variable named ",(0,a.kt)("inlineCode",{parentName:"p"},"csd"),". "),(0,a.kt)("p",null,"Next, will will have Csound load the CSD and play the CSD. Modify the startCsound() function to use:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"  csound = await Csound();\n\n  await csound.compileCsdText(csd);\n  await csound.start();\n\n  document.querySelector('#startButton').remove();\n")),(0,a.kt)("p",null,"Now when you press the button you should hear the CSD playing in the browser and the button has disappeared.  "),(0,a.kt)("h2",{id:"step-4---building-the-application"},"Step 4 - Building the Application"),(0,a.kt)("p",null,"Up until now we've been running the web application with a test web server and hot reloading. Now let's go to the terminal and run:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"npm run build\n")),(0,a.kt)("p",null,"This will run vite to bundle and minify our JavaScript and CSS code and output a self-contained web application in the dist folder. You can run:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"npm run preview\n")),(0,a.kt)("p",null,"to test serving the built output. "),(0,a.kt)("p",null,"The dist folder can now be deployed and served on a hosting site (such as Github Pages). For more information and examples of how to deploy to common hosting sites, see Vite's documentation on ",(0,a.kt)("a",{parentName:"p",href:"https://vitejs.dev/guide/static-deploy.html"},'"Deploying a Static Site"'),"."),(0,a.kt)("h2",{id:"summary"},"Summary"),(0,a.kt)("p",null,"Congratulations! You now have a basic Csound web application that renders Csound projects in the browser. Being able to take a work that runs on the desktop and have it run in the browser is a big first-step. We'll continue on in the next tutorial to learn more about the Csound API to create interactive audio projects."))}c.isMDXComponent=!0}}]);